# Домашнее задание к занятию "Компоненты Kubernetes"

### Цель задания

Рассчитать требования к кластеру под проект.

### Инструменты и дополнительные материалы, которые пригодятся для выполнения задания

- [Considerations for large clusters](https://kubernetes.io/docs/setup/best-practices/cluster-large/)
- [Architecting Kubernetes clusters — choosing a worker node size](https://learnk8s.io/kubernetes-node-size)

------

### Задание. Необходимо определить требуемые ресурсы

Известно, что проекту нужны база данных и система кеширования. Приложение состоит из бекенда и фронтенда.    
Опишите, какие ресурсы требуются при условии, что:   

1. Необходимо упаковать приложение в чарт для деплоя в разные окружения. 
2. База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
3. Кэш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
4. Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий. 
5. Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

**План расчёта**

1. Сделайте расчет всех необходимых ресурсов.

Перечислим в таблице все требуемые ресурсы и расчитаем на общее потребление
| имя         | ядро | озу | копий | ядро*копий | озу*копий |
|---          |---  |---   |--- |--- |---    |
| База данных | 1   | 4    | 3  | 3  | 12    |
| Кэш         | 1   | 4    | 3  | 3  | 12    |
| Фронтенд    | 0.2 | 0.05 | 5  | 1  | 0.25  |
| Бекенд      | 1   | 0.6  | 10 | 10 | 6     |
| Всего       | 3.2 | 8.65 | 21 | 17 | 30.25 |

2. Спланируйте количество рабочих нод, которые справятся с такой нагрузкой. 

Будем исходить из наличия минимум трех worker нод и трех control нод.
Разделим общее потребление на количество нод и округлим до ближайщего большего целого числа.
| назначение ноды | ядро | озу |
| ---             | ---  | --- |
| control         | 1    | 1   |
| control         | 1    | 1   |
| control         | 1    | 1   |
| worker          | 6    | 11  |
| worker          | 6    | 11  |
| worker          | 6    | 11  |
| всего           | 21   | 36  |

3. Добавьте к полученным цифрам запас, который учитывает выход из строя как минимум одной ноды. 

Для обеспечения выхода из строя одной из нод разделим общее потребление на (количество нод - 1) и округлим до ближайщего большего целого числа.
| назначение ноды | ядро | озу |
| ---             | ---  | --- |
| control         | 1    | 1   |
| control         | 1    | 1   |
| control         | 1    | 1   |
| worker          | 9    | 16  |
| worker          | 9    | 16  |
| worker          | 9    | 16  |
| всего           | 30   | 51  |

4. Добавьте служебные ресурсы к нодам. Помните, что для разных типов нод требовния к ресурсам разные. 

Добавим на каждую рабочую ноду минимум по 1 ядру и 2Гб озу.
| назначение ноды | ядро | озу |
| ---             | ---  | --- |
| control         | 1    | 1   |
| control         | 1    | 1   |
| control         | 1    | 1   |
| worker          | 10   | 18  |
| worker          | 10   | 18  |
| worker          | 10   | 18  |
| всего           | 43   | 57  |


5. В результате должно быть указано количество нод и их параметры.


----

### Правила приема работы

Домашняя работа оформляется в своем Git репозитории в файле README.md. Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.
